
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда




#Область ПрограммныйИнтерфейс

Функция ПроверкаНаВнутреннегоКонтрагента(Контрагент) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	1 КАК Поле1
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.Контрагент = &Контрагент";
	
	Запрос.УстановитьПараметр("Контрагент", Контрагент);
	РезультатЗапроса = Запрос.Выполнить();
		
	Возврат Не РезультатЗапроса.Пустой();	
	
	
КонецФункции

Функция ПолучитьОрганизациюПоКонтрагенту(Контрагент) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Организации.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.Контрагент = &Контрагент";
	
	Запрос.УстановитьПараметр("Контрагент", Контрагент);
	РезультатЗапроса = Запрос.Выполнить();
	Если РезультатЗапроса.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	Возврат Выборка.Ссылка;
	
	
КонецФункции

Функция ПолучитьОрганизациюПоЕДРПО(ЕДРПОУ)Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Организации.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.КодПоЕДРПОУ = &КодПоЕДРПОУ";
	
	Запрос.УстановитьПараметр("КодПоЕДРПОУ", ЕДРПОУ);
	РезультатЗапроса = Запрос.Выполнить();
	Если РезультатЗапроса.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	Возврат Выборка.Ссылка;

КонецФункции

Функция ПолучитьОрганизациюПоИНН(ИНН)Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаОрганизацийСрезПоследних.Организация КАК Организация
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаОрганизаций.СрезПоследних(&НаДату, ИННПлательщикаНДС = &ИНН) КАК УчетнаяПолитикаОрганизацийСрезПоследних";
	
	Запрос.УстановитьПараметр("НаДату", ТекущаяДата());
	Запрос.УстановитьПараметр("ИНН", ИНН);
	
	РезультатЗапроса = Запрос.Выполнить();
	Если РезультатЗапроса.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	Возврат Выборка.Ссылка;

КонецФункции


Функция ПолучитьРеквизитыОрганизации(Дата, Организация, ВидСчета = Неопределено)Экспорт
	
	ДанныеОрганизаций = Новый Структура;
	
	ИД_Организации = "Орг_" + СтрЗаменить(Строка(Организация.УникальныйИдентификатор()), "-", "_");
	
	СтрокаПараметровИНН = "ПлательщикЕН, ПлательщикНДС, ИНН, НомерСвидетельства, ПлательщикНалогаНаПрибыль";
	СтрокаПараметровРуководители = "Руководитель, РуководительКод";
	
	Если ВидСчета = Неопределено Тогда
		ВидСчета = "Текущий";
	КонецЕсли; 
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Дата", Дата);
	Запрос.УстановитьПараметр("ВидСчета", ВидСчета);

	Запрос.Текст = "ВЫБРАТЬ
	               |	Организации.НаименованиеПолное КАК НаименованиеПолное,
	               |	Организации.ЮрФизЛицо КАК ЮрФизЛицо,
	               |	Организации.КодПоЕДРПОУ КАК КодПоЕДРПОУ,
	               |	ОрганизацииКонтактнаяИнформация.Представление КАК Адрес
	               |ИЗ
	               |	Справочник.Организации.КонтактнаяИнформация КАК ОрганизацииКонтактнаяИнформация
	               |		ПРАВОЕ СОЕДИНЕНИЕ Справочник.Организации КАК Организации
	               |		ПО ОрганизацииКонтактнаяИнформация.Ссылка = Организации.Ссылка
	               |			И (ОрганизацииКонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.Адрес))
	               |ГДЕ
	               |	Организации.Ссылка = &Организация
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	УчетнаяПолитикаОрганизацийСрезПоследних.ПлательщикЕН КАК ПлательщикЕН,
	               |	УчетнаяПолитикаОрганизацийСрезПоследних.ПлательщикНДС КАК ПлательщикНДС,
	               |	УчетнаяПолитикаОрганизацийСрезПоследних.ИННПлательщикаНДС КАК ИНН,
	               |	УчетнаяПолитикаОрганизацийСрезПоследних.НомерСвидетельстваПлательщикаНДС КАК НомерСвидетельства,
	               |	УчетнаяПолитикаОрганизацийСрезПоследних.ПлательщикНалогаНаПрибыль КАК ПлательщикНалогаНаПрибыль
	               |ИЗ
	               |	РегистрСведений.УчетнаяПолитикаОрганизаций.СрезПоследних(&Дата, Организация = &Организация) КАК УчетнаяПолитикаОрганизацийСрезПоследних
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо.Представление КАК Руководитель,
	               |	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо.Код КАК РуководительКод
	               |ИЗ
	               |	РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних(&Дата, СтруктурнаяЕдиница = &Организация) КАК ОтветственныеЛицаОрганизацийСрезПоследних
	               |ГДЕ
	               |	ОтветственныеЛицаОрганизацийСрезПоследних.ОтветственноеЛицо = ЗНАЧЕНИЕ(Перечисление.ОтветственныеЛицаОрганизаций.Руководитель)
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо.Представление КАК ГлавныйБухгалтер,
	               |	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо.Код КАК ГлавныйБухгалтерКод
	               |ИЗ
	               |	РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних(&Дата, СтруктурнаяЕдиница = &Организация) КАК ОтветственныеЛицаОрганизацийСрезПоследних
	               |ГДЕ
	               |	ОтветственныеЛицаОрганизацийСрезПоследних.ОтветственноеЛицо = ЗНАЧЕНИЕ(Перечисление.ОтветственныеЛицаОрганизаций.ГлавныйБухгалтер)
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	БанковскиеСчетаОрганизаций.Ссылка КАК Ссылка,
	               |	БанковскиеСчетаОрганизаций.НомерСчета КАК НомерСчета,
	               |	БанковскиеСчетаОрганизаций.КодБанка КАК КодБанка,
	               |	БанковскиеСчетаОрганизаций.НаименованиеБанка КАК НаименованиеБанка,
	               |	БанковскиеСчетаОрганизаций.АдресБанка КАК АдресБанка
	               |ИЗ
	               |	Справочник.БанковскиеСчетаОрганизаций КАК БанковскиеСчетаОрганизаций
	               |ГДЕ
	               |	БанковскиеСчетаОрганизаций.ВидСчета = &ВидСчета
	               |	И БанковскиеСчетаОрганизаций.Владелец = &Организация
	               |	И НЕ БанковскиеСчетаОрганизаций.Закрыт";
	
	
	МассивРезультатов = Запрос.ВыполнитьПакет();
	
	Реквизиты = МассивРезультатов[0].Выбрать();
	ВыборкаИНН = МассивРезультатов[1].Выбрать();
	ВыборкаРуководитель = МассивРезультатов[2].Выбрать();
	ВыборкаГлавныйБухгалтер = МассивРезультатов[3].Выбрать();
	ВыборкаБС = МассивРезультатов[4].Выбрать();
					
	Реквизиты.Следующий();
	СтруктураРеквизитов = Новый Структура;
	СтруктураРеквизитов.Вставить("НаименованиеПолное", Реквизиты.НаименованиеПолное);
	СтруктураРеквизитов.Вставить("ЮрЛицо", Реквизиты.ЮрФизЛицо = Перечисления.ЮрФизЛицо.ЮрЛицо);
	СтруктураРеквизитов.Вставить("КодПоЕДРПОУ", Реквизиты.КодПоЕДРПОУ);		
	СтруктураРеквизитов.Вставить("Адрес", Реквизиты.Адрес);		
	ВыборкаРуководитель.Следующий();
	СтруктураРеквизитов.Вставить("Руководитель", ВыборкаРуководитель.Руководитель);	
	СтруктураРеквизитов.Вставить("РуководительКод", ВыборкаРуководитель.РуководительКод);
	ВыборкаГлавныйБухгалтер.Следующий();
	СтруктураРеквизитов.Вставить("ГлавныйБухгалтер", ВыборкаГлавныйБухгалтер.ГлавныйБухгалтер);	
	СтруктураРеквизитов.Вставить("ГлавныйБухгалтерКод", ВыборкаГлавныйБухгалтер.ГлавныйБухгалтерКод);
	ВыборкаИНН.Следующий();
	СтруктураРеквизитов.Вставить("ПлательщикЕН", ВыборкаИНН.ПлательщикЕН);
	СтруктураРеквизитов.Вставить("ПлательщикНДС", ВыборкаИНН.ПлательщикНДС);
	СтруктураРеквизитов.Вставить("ИНН", ВыборкаИНН.ИНН);
	СтруктураРеквизитов.Вставить("НомерСвидетельства", ВыборкаИНН.НомерСвидетельства);
	СтруктураРеквизитов.Вставить("ПлательщикНалогаНаПрибыль", ВыборкаИНН.ПлательщикНалогаНаПрибыль);
	ВыборкаБС.Следующий();
	СтруктураРеквизитов.Вставить("НомерСчета", 			ВыборкаБС.НомерСчета);		
	СтруктураРеквизитов.Вставить("КодБанка", 			ВыборкаБС.КодБанка);		
	СтруктураРеквизитов.Вставить("НаименованиеБанка", 	ВыборкаБС.НаименованиеБанка);		
	СтруктураРеквизитов.Вставить("АдресБанка", 			ВыборкаБС.АдресБанка);		

	Возврат СтруктураРеквизитов;
КонецФункции



Функция ПолучитьПредставлениеДляПечати(Организация, Наименование = Истина, ИНН = Ложь, ЕДРПОУ = Ложь, Адрес = Ложь, Телефон = Ложь, НаДату = Неопределено, КодЯзыка = Неопределено, БанковскийСчет = Неопределено, Разделитель = ", ", ПолучитьСтруктуру = Ложь, ТипДокументаПечати = Неопределено, Регл = Истина,тВидСчета = "Текущий") Экспорт 
	
	УстановитьПривилегированныйРежим(Истина);
	
	ПредставлениеДляПечати = "";
	
	Если НаДату = Неопределено Тогда 
		НаДату = ТекущаяДата();
	КонецЕсли;
	
	Если КодЯзыка = Неопределено Тогда 
		КодЯзыка = Лев(КодЛокализацииИнформационнойБазы(), 2);
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	Организации.Ссылка КАК Ссылка,
	               |	Организации.Наименование КАК Наименование,
	               |	Организации.НаименованиеПолное КАК НаименованиеПолное,
	               |	Организации.КодПоЕДРПОУ КАК КодПоЕДРПОУ,
	               |	ЕСТЬNULL(УчетнаяПолитикаОрганизацийСрезПоследних.ИННПлательщикаНДС, """") КАК ИНН,
	               |	БанковскиеСчетаОрганизаций.НомерСчета КАК НомерСчета,
	               |	БанковскиеСчетаОрганизаций.Банк.Наименование КАК НаименованиеБанка,
	               |	БанковскиеСчетаОрганизаций.ВалютаДенежныхСредств КАК Валюта,
	               |	БанковскиеСчетаОрганизаций.Банк.Код КАК КодБанка,
	               |	1 КАК Порядок
	               |ПОМЕСТИТЬ ВТ_Реквизиты
	               |ИЗ
	               |	Справочник.Организации КАК Организации
	               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаОрганизаций.СрезПоследних(&НаДату, Организация = &Ссылка) КАК УчетнаяПолитикаОрганизацийСрезПоследних
	               |		ПО (УчетнаяПолитикаОрганизацийСрезПоследних.Организация = Организации.Ссылка)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.БанковскиеСчетаОрганизаций КАК БанковскиеСчетаОрганизаций
	               |		ПО (БанковскиеСчетаОрганизаций.Владелец = Организации.Ссылка)
	               |			И (БанковскиеСчетаОрганизаций.ВидСчета = &ВидСчета)
	               |			И (НЕ БанковскиеСчетаОрганизаций.Закрыт)
	               |			И (НЕ БанковскиеСчетаОрганизаций.ПометкаУдаления)
	               |ГДЕ
	               |	Организации.Ссылка = &Ссылка
	               |	И БанковскиеСчетаОрганизаций.НомерСчета <> """"
	               |
	               |ОБЪЕДИНИТЬ ВСЕ
	               |
	               |ВЫБРАТЬ
	               |	Организации.Ссылка,
	               |	Организации.Наименование,
	               |	Организации.НаименованиеПолное,
	               |	Организации.КодПоЕДРПОУ,
	               |	ЕСТЬNULL(УчетнаяПолитикаОрганизацийСрезПоследних.ИННПлательщикаНДС, """"),
	               |	БанковскиеСчетаОрганизаций.НомерСчета,
	               |	БанковскиеСчетаОрганизаций.Банк.Наименование,
	               |	БанковскиеСчетаОрганизаций.ВалютаДенежныхСредств,
	               |	БанковскиеСчетаОрганизаций.Банк.Код,
	               |	2
	               |ИЗ
	               |	Справочник.Организации КАК Организации
	               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаОрганизаций.СрезПоследних(&НаДату, Организация = &Ссылка) КАК УчетнаяПолитикаОрганизацийСрезПоследних
	               |		ПО (УчетнаяПолитикаОрганизацийСрезПоследних.Организация = Организации.Ссылка)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.БанковскиеСчетаОрганизаций КАК БанковскиеСчетаОрганизаций
	               |		ПО (БанковскиеСчетаОрганизаций.Владелец = Организации.Ссылка)
	               |			И (БанковскиеСчетаОрганизаций.ВидСчета = ""Текущий"")
	               |			И (НЕ БанковскиеСчетаОрганизаций.Закрыт)
	               |			И (НЕ БанковскиеСчетаОрганизаций.ПометкаУдаления)
	               |ГДЕ
	               |	Организации.Ссылка = &Ссылка
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ ПЕРВЫЕ 1
	               |	ВТ_Реквизиты.Ссылка КАК Ссылка,
	               |	ВТ_Реквизиты.Наименование КАК Наименование,
	               |	ВТ_Реквизиты.НаименованиеПолное КАК НаименованиеПолное,
	               |	ВТ_Реквизиты.КодПоЕДРПОУ КАК КодПоЕДРПОУ,
	               |	ВТ_Реквизиты.ИНН КАК ИНН,
	               |	ВТ_Реквизиты.НомерСчета КАК НомерСчета,
	               |	ВТ_Реквизиты.НаименованиеБанка КАК НаименованиеБанка,
	               |	ВТ_Реквизиты.Валюта КАК Валюта,
	               |	ВТ_Реквизиты.КодБанка КАК КодБанка,
	               |	ВТ_Реквизиты.Порядок КАК Порядок
	               |ИЗ
	               |	ВТ_Реквизиты КАК ВТ_Реквизиты
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	Порядок";
	
	Запрос.УстановитьПараметр("Ссылка", Организация);
	Запрос.УстановитьПараметр("НаДату", НаДату);
	Запрос.УстановитьПараметр("ВидСчета", тВидСчета);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	СтруктураПредставления = Новый Структура;	
	Если Выборка.Следующий() Тогда 
		Если Наименование Тогда 
			Если ЗначениеЗаполнено(Выборка.НаименованиеПолное) Тогда 
				СтруктураПредставления.Вставить("Наименование", СокрЛП(Выборка.НаименованиеПолное));
			Иначе
				СтруктураПредставления.Вставить("Наименование", СокрЛП(Выборка.Наименование));
			КонецЕсли;
		КонецЕсли;
	
		Если ИНН И ЗначениеЗаполнено(Выборка.ИНН) Тогда 
			СтруктураПредставления.Вставить("ИНН", НСтр("ru = 'ИНН '; uk = 'ІПН '", КодЯзыка) + СокрЛП(Выборка.ИНН));
		КонецЕсли;
		
		Если ЕДРПОУ И ЗначениеЗаполнено(Выборка.КодПоЕДРПОУ) Тогда 
			СтруктураПредставления.Вставить("ЕДРПОУ", НСтр("ru = 'Код по ЕГРПОУ '; uk = 'Код за ЄДРПОУ '", КодЯзыка) + СокрЛП(Выборка.КодПоЕДРПОУ));
		КонецЕсли;
		
		Если Адрес Тогда 
			ВидКонтИнфор = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("ЮридическийАдресОрганизации");
			тАдрес = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформацииОбъекта(Организация, ВидКонтИнфор,, НаДату);
			тАдрес = СтрЗаменить(тАдрес," дом ", " буд "); 
			Если ЗначениеЗаполнено(тАдрес) Тогда 
				СтруктураПредставления.Вставить("Адрес", СокрЛП(тАдрес));
			КонецЕсли;
		КонецЕсли;
		
		Если Телефон Тогда 
			ВидКонтИнфор = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("ТелефонОрганизации");

			тТелефон = УправлениеКонтактнойИнформацией.ПредставлениеКонтактнойИнформацииОбъекта(Организация, ВидКонтИнфор,, НаДату);
			Если ЗначениеЗаполнено(тТелефон) Тогда 
				СтруктураПредставления.Вставить("Телефон", "тел.: " + СокрЛП(тТелефон));
			КонецЕсли;
		КонецЕсли;
		
		Если БанковскийСчет<>Неопределено и ЗначениеЗаполнено(Выборка.НомерСчета) Тогда 
			Если Организация = Справочники.Организации.НайтиПоКоду("38397793") И ТипДокументаПечати = Тип("ДокументСсылка.РеализацияТоваров") Тогда 
					тБанковскийСчет = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru = '  !!!  ВНИМАНИЕ НОВЫЕ РЕКВИЗИТЫ НА ОПЛАТУ  !!! р/с %1 (%2) в %3, МФО: %4 '; uk = '  !!!  УВАГА НОВІ РЕКВІЗИТИ ОПЛАТИ  !!!   р/р %1 (%2) у %3, МФО: %4'", КодЯзыка),
									СокрЛП(Выборка.НомерСчета),
									СокрЛП(Выборка.Валюта),
									СокрЛП(Выборка.НаименованиеБанка),
									СокрЛП(Выборка.КодБанка));			
			Иначе	
					тБанковскийСчет = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru = 'р/с %1 (%2) в %3, МФО: %4 '; uk = 'р/р %1 (%2) у %3, МФО: %4'", КодЯзыка),
									СокрЛП(Выборка.НомерСчета),
									СокрЛП(Выборка.Валюта),
									СокрЛП(Выборка.НаименованиеБанка),
									СокрЛП(Выборка.КодБанка));			
			КонецЕсли;
			
			Если ЗначениеЗаполнено(тБанковскийСчет) Тогда
				СтруктураПредставления.Вставить("БанковскийСчет", тБанковскийСчет);	
			КонецЕсли;
		КонецЕсли;
	ИначеЕсли Наименование Тогда 
		СтруктураПредставления.Вставить("Наименование", Строка(Организация));
	КонецЕсли;
	
	УстановитьПривилегированныйРежим(Ложь);
	
	Если ПолучитьСтруктуру Тогда 
		Возврат СтруктураПредставления;
	Иначе
		Для Каждого Стр Из СтруктураПредставления Цикл 
			ПредставлениеДляПечати = ?(Не ПустаяСтрока(ПредставлениеДляПечати), ПредставлениеДляПечати + Разделитель, "") + Стр.Значение;
		КонецЦикла;
		
		Возврат ПредставлениеДляПечати;
	КонецЕсли;		
	
КонецФункции

Функция ПолучитьОрганизациюПоGLN(GLN)Экспорт
	
	//
	/////Организации логина ЕДИ схидна тк - после перевода на один логин убрать
	//Если  GLN = "9864232378839" Тогда
	//	Возврат  Справочники.Организации.НайтиПоКоду("CON000153"); //ТЮТЮНОВА КОМПАНІЯ СЛОБОЖАНЩИНИ ТОВ
	//КонецЕсли;
	
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Организации.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.GLN = &GLN
	|	И НЕ Организации.ПометкаУдаления";
	
	Запрос.УстановитьПараметр("GLN", GLN);
	
	РезультатЗапроса = Запрос.Выполнить();
	Если РезультатЗапроса.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;
		
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	ВыборкаДетальныеЗаписи.Следующий();
	
	Возврат ВыборкаДетальныеЗаписи.Ссылка;
	
 КонецФункции


Функция ПолучитьОрганизациюНоменклатуры(Организация,Номенклатура,ТорговаяПлощадка = Неопределено)Экспорт
	
		
	Если ТипЗнч(Номенклатура) <> Тип("СправочникСсылка.Номенклатура") Тогда
		Возврат Организация;
	КонецЕсли;
	
	СписокНоменклатуры	= Новый Массив;
	СписокНоменклатуры.Добавить(Номенклатура);
	СтруктураОрганизация = РегистрыСведений.ТК_РазделениеНоменклатурыПоОрганизациям.ПолучитьОрганизациюСпискаНоменклатуры(Организация,СписокНоменклатуры,ТорговаяПлощадка).Получить(Номенклатура);
	
	ОрганизацияНоменклатуры = СтруктураОрганизация.Организация;
	
	Возврат ОрганизацияНоменклатуры;
	
КонецФункции


 
 
// См. ЗапретРедактированияРеквизитовОбъектовПереопределяемый.ПриОпределенииОбъектовСЗаблокированнымиРеквизитами.
Функция ПолучитьБлокируемыеРеквизитыОбъекта() Экспорт
	
	БлокируемыеРеквизиты = Новый Массив;
	
	БлокируемыеРеквизиты.Добавить("Код");
	
	Возврат БлокируемыеРеквизиты;
	
КонецФункции

// Конец СтандартныеПодсистемы.ЗапретРедактированияРеквизитовОбъектов



#Область ДляВызоваИзДругихПодсистем

// СтандартныеПодсистемы.УправлениеДоступом

// См. УправлениеДоступомПереопределяемый.ПриЗаполненииСписковСОграничениемДоступа.
Процедура ПриЗаполненииОграниченияДоступа(Ограничение) Экспорт
	
	Ограничение.Текст =
	"РазрешитьЧтениеИзменение
	|ГДЕ
	|	ЗначениеРазрешено(Ссылка)";
	
	Ограничение.ТекстДляВнешнихПользователей = Ограничение.Текст;
	
КонецПроцедуры

// Конец СтандартныеПодсистемы.УправлениеДоступом

#КонецОбласти


Функция ПолучитьОрганизациюПоКлючуФоновогоЗадания(КлючФоновогоЗадания) Экспорт

	ПозицияРазделителя = Найти(КлючФоновогоЗадания, "UID#");
	
	УникальныйИдентификаторСклада = Сред(КлючФоновогоЗадания, ПозицияРазделителя + 4);
	
	Возврат Справочники.Организации.ПолучитьСсылку(Новый УникальныйИдентификатор(УникальныйИдентификаторСклада));

КонецФункции 

Функция ПолучитьКлючФоновогоЗаданияПоОрганизации(Организация) Экспорт

	Возврат СокрЛП(Организация.Наименование) + ", UID#" + Организация.УникальныйИдентификатор();	

КонецФункции 





#КонецОбласти


#КонецЕсли
