#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

   
 	ДополнительныеПараметры = УправлениеКонтактнойИнформацией.ПараметрыКонтактнойИнформации();

    ДополнительныеПараметры.Вставить("ИмяЭлементаДляРазмещения", "ГруппаКонтактнаяИнформация");

    УправлениеКонтактнойИнформацией.ПриСозданииНаСервере(ЭтотОбъект, Объект, ДополнительныеПараметры);
	
	Если РольДоступна("ТК_КазначействоБазовые") Тогда 
		Элементы.Тарифы.Видимость = Истина;
	КонецЕсли;

КонецПроцедуры

&НаСервере
Процедура ПриЧтенииНаСервере(ТекущийОбъект)

   

    // СтандартныеПодсистемы.КонтактнаяИнформация

    УправлениеКонтактнойИнформацией.ПриЧтенииНаСервере(ЭтотОбъект, ТекущийОбъект);

    // Конец СтандартныеПодсистемы.КонтактнаяИнформация

   

КонецПроцедуры

&НаСервере
Процедура ОбработкаПроверкиЗаполненияНаСервере(Отказ, ПроверяемыеРеквизиты)

   

    // СтандартныеПодсистемы.КонтактнаяИнформация

    УправлениеКонтактнойИнформацией.ОбработкаПроверкиЗаполненияНаСервере(ЭтотОбъект, Объект, Отказ);

    // Конец СтандартныеПодсистемы.КонтактнаяИнформация

КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)

   

    // СтандартныеПодсистемы.КонтактнаяИнформация

    УправлениеКонтактнойИнформацией.ПередЗаписьюНаСервере(ЭтотОбъект, ТекущийОбъект);

    // Конец СтандартныеПодсистемы.КонтактнаяИнформация

КонецПроцедуры

&НаСервере
Процедура ПослеЗаписиНаСервере(ТекущийОбъект, ПараметрыЗаписи)

   

    // СтандартныеПодсистемы.КонтактнаяИнформация

    УправлениеКонтактнойИнформацией.ПослеЗаписиНаСервере(ЭтотОбъект, ТекущийОбъект);

    // Конец СтандартныеПодсистемы.КонтактнаяИнформация

   

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции
////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ ПОДСИСТЕМЫ "КОНТАКТНАЯ ИНФОРМАЦИЯ"
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияПриИзменении(Элемент)
    УправлениеКонтактнойИнформациейКлиент.ПриИзменении(ЭтотОбъект, Элемент);
КонецПроцедуры
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачалоВыбора(ЭтотОбъект, Элемент, ,СтандартнаяОбработка); 
КонецПроцедуры
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияПриНажатии(Элемент, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачалоВыбора(ЭтотОбъект, Элемент, ,СтандартнаяОбработка); 
КонецПроцедуры
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОчистка(Элемент, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.Очистка(ЭтотОбъект, Элемент, ,СтандартнаяОбработка);
КонецПроцедуры
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияВыполнитьКоманду(Команда)
    УправлениеКонтактнойИнформациейКлиент.ВыполнитьКоманду(ЭтотОбъект, Команда.Имя);    
КонецПроцедуры
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияАвтоПодбор(Элемент, Текст, ДанныеВыбора, ПараметрыПолученияДанных, Ожидание, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.АвтоПодбор(Текст, ДанныеВыбора, СтандартнаяОбработка);    
КонецПроцедуры
 
&НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.ОбработкаВыбора(ЭтотОбъект, ВыбранноеЗначение, Элемент.Имя, СтандартнаяОбработка);    
КонецПроцедуры
 
&НаСервере
Процедура Подключаемый_ОбновитьКонтактнуюИнформацию(Результат) Экспорт
    УправлениеКонтактнойИнформацией.ОбновитьКонтактнуюИнформацию(ЭтотОбъект, Объект, Результат);    
КонецПроцедуры
 
&НаСервере
Процедура КонтактнаяИнформацияПриСменеСтраницы()
    УправлениеКонтактнойИнформацией.ВыполнитьОтложеннуюИнициализацию(ЭтотОбъект, Объект);
КонецПроцедуры

&НаСервере
Процедура ВидЗаказаПриИзмененииНаСервере()
	
КонецПроцедуры

&НаКлиенте
Процедура ВидЗаказаПриИзменении(Элемент)
	
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбораДинамическогоСписка(
			ТаблицаТарифов, 
			"Операция", 
			ВидЗаказа, 
			ВидСравненияКомпоновкиДанных.Равно,
			, 
			ЗначениеЗаполнено(ВидЗаказа));
	

КонецПроцедуры

&НаКлиенте
Процедура СтраницыПриСменеСтраницы(Элемент, ТекущаяСтраница)
	Если ТекущаяСтраница = Элементы.Тарифы Тогда
		 ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбораДинамическогоСписка(
			ТаблицаТарифов, 
			"Партнер", 
			Объект.Ссылка, 
			ВидСравненияКомпоновкиДанных.Равно,
			, 
			ЗначениеЗаполнено(Объект.Ссылка));
	КонецЕсли;
КонецПроцедуры

&НаСервере
Функция СписокКонтрагентовОсновнойПартнерПриИзмененииНаСервере(Контрагент)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПартнерыКазначействоСписокКонтрагентов.Ссылка.Наименование КАК Наименование
		|ИЗ
		|	Справочник.ПартнерыКазначейство.СписокКонтрагентов КАК ПартнерыКазначействоСписокКонтрагентов
		|ГДЕ
		|	ПартнерыКазначействоСписокКонтрагентов.Ссылка.Ссылка <> &Ссылка
		|	И ПартнерыКазначействоСписокКонтрагентов.Контрагенты = &Контрагенты
		|	И ПартнерыКазначействоСписокКонтрагентов.ОсновнойПартнер";
	
	Запрос.УстановитьПараметр("Контрагенты", Контрагент);
	Запрос.УстановитьПараметр("Ссылка", Объект.Ссылка);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если РезультатЗапроса.Пустой() Тогда 
		Возврат "Нет основного";
	Иначе 
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		ВыборкаДетальныеЗаписи.Следующий();
		Возврат ВыборкаДетальныеЗаписи.Наименование;
	КонецЕсли;
	
КонецФункции

&НаКлиенте
Процедура СписокКонтрагентовОсновнойПартнерПриИзменении(Элемент)
	Контрагент = ЭтаФорма.ТекущийЭлемент.ТекущиеДанные.Контрагенты;
	Партнер = СписокКонтрагентовОсновнойПартнерПриИзмененииНаСервере(Контрагент);
	
	Если Партнер = "Нет основного" Тогда
	Иначе
		ОбщегоНазначенияКлиент.СообщитьПользователю("Для данного контрагента основным партнером является "+Партнер);
		ЭтаФорма.ТекущийЭлемент.ТекущиеДанные.ОсновнойПартнер = ложь;
	КонецЕсли;
	
КонецПроцедуры
 
 
#КонецОбласти