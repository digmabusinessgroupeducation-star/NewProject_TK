<ПравилаОбмена>
	<ВерсияФормата РежимСовместимости="РежимСовместимостиСБСП20">2.01</ВерсияФормата>
	<Ид>3f3d0eaa-6890-4574-8e75-8c8a980d1630    </Ид>
	<Наименование>БухгалтерияДляУкраины --&gt; ТК_ssl</Наименование>
	<ДатаВремяСоздания>2024-08-12T14:05:55</ДатаВремяСоздания>
	<Источник ВерсияПлатформы="8.0" ВерсияКонфигурации="1.2.40.2" СинонимКонфигурации="Бухгалтерия для Украины, редакция 1.2">БухгалтерияДляУкраины</Источник>
	<Приемник ВерсияПлатформы="8.0" ВерсияКонфигурации="1.0.1.25" СинонимКонфигурации="ТК">ТК</Приемник>
	<ПослеЗагрузкиПравилОбмена>Получатель  = ПланыОбмена.ОбменБанкТК.НайтиПоКоду("SSL"); 

Если Получатель.Пустая() Тогда
	
	НовыйУзел = ПланыОбмена.ОбменБанкТК.СоздатьУзел();
	НовыйУзел.Код="SSL";
	НовыйУзел.Наименование = "Банк в ТКssl";
	НовыйУзел.НомерОтправленного = 0;
	НовыйУзел.НомерПринятого = 0;
	НовыйУзел.Записать();
	
	Получатель  = НовыйУзел.Ссылка;
	
Иначе
	
	Если Получатель.ПометкаУдаления
		ИЛИ Получатель.Наименование &lt;&gt; "Банк в ТКssl" Тогда
		
		Узел = Получатель.ПолучитьОбъект();
		Узел.ПометкаУдаления = Ложь;
		Узел.Наименование = "Банк в ТКssl";
		Узел.Записать();
		
	КонецЕсли;
	
КонецЕсли;

</ПослеЗагрузкиПравилОбмена>
	<ПередВыгрузкойДанных>СписокДДС = Новый СписокЗначений;
СписокДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000357")); //Расчеты с поставщиками
СписокДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000400")); //Бонусы от поставщиков
СписокДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000432")); //Выручка от реализации товаров ОПТ
СписокДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000402")); //Торговая выручка  POS терминалы
Параметры.Вставить("СписокДДС",СписокДДС);

СписокИсключений = Новый СписокЗначений;                     
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000004")); //Гринстеп
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000003")); //Интеллект Центр
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000011")); //СУШИ ГОУ
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000010")); //Ти.Ди.МАРК ООО
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000009")); //ТРЕНО СК
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000005")); //Элитагаз
//СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000006")); //Фабрика Сыра
СписокИсключений.Добавить(Справочники.Подразделения.НайтиПоКоду("000000007")); //Бизнесс-групп Дигма
Параметры.Вставить("СписокИсключений",СписокИсключений);

СписокАттикаПодразделение = Новый СписокЗначений;
СписокАттикаПодразделение.Добавить(Справочники.Подразделения.НайтиПоКоду("000000002")); //ТС Аттика
Параметры.Вставить("СписокИсключенийАттика",СписокАттикаПодразделение);

СписокИсключенийДДС = Новый СписокЗначений;
СписокИсключенийДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000400")); //Бонусы от поставщиков
Параметры.Вставить("СписокИсключенийДДС",СписокИсключенийДДС);

НеПерегружаемыйСписокИсключенийДДС = Новый СписокЗначений;
НеПерегружаемыйСписокИсключенийДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000400")); //Бонусы от поставщиков (Vov41k 24.07.2023 - по просьбе Василенко М.)
НеПерегружаемыйСписокИсключенийДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000437")); //Финансовые перемещения
НеПерегружаемыйСписокИсключенийДДС.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000394")); //Перемещение денежных средств между контрагентами
Параметры.Вставить("НеПерегружаемыйСписокИсключенийДДС",НеПерегружаемыйСписокИсключенийДДС);

НеПерегружаемыеОбъекты = Новый СписокЗначений;
НеПерегружаемыеОбъекты.Добавить(Справочники.Объекты.НайтиПоКоду("ХGL000115")); //Бизнес Групп Дигма
Параметры.Вставить("НеПерегружаемыеОбъекты",НеПерегружаемыеОбъекты);

Параметры.Вставить("СвойствоНеПерегружать",ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("014"));// Свойство объектов "Не перегружать в ТК"

СписокПерегружаемыхСчетов = Новый СписокЗначений;
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.РасчетыСПокупателямиБонусы);
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.РасчетыСОтечественнымиПоставщикамиОбщий);
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.РасчетыСОтечественнымиПокупателямиОбщие);
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.НайтиПоКоду("6871"));
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.НайтиПоКоду("6872"));
//СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.НайтиПоКоду("6855"));
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.НайтиПоКоду("331"));
СписокПерегружаемыхСчетов.Добавить(ПланыСчетов.Хозрасчетный.НайтиПоКоду("68542"));
Параметры.Вставить("СписокПерегружаемыхСчетов",СписокПерегружаемыхСчетов);

СписокВыгружаемыхСтатейДДС6855 = Новый СписокЗначений;
//СписокВыгружаемыхСтатейДДС6855.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000330")); //Упаковочные материалы (пакеты фасовочные, сетка упаковочная,пленка ПВХ)
//СписокВыгружаемыхСтатейДДС6855.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000328")); //Палетный стретч
//СписокВыгружаемыхСтатейДДС6855.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000329")); //Расходные материалы для касс. и торг.-произв. оборудования (кас.лента,термоэтикет,сухой лед, ножи)
Параметры.Вставить("СписокВыгружаемыхСтатейДДС6855",СписокВыгружаемыхСтатейДДС6855);

СписокПерегружаемыхСчетов6855 = Новый СписокЗначений;
СписокПерегружаемыхСчетов6855.Добавить(ПланыСчетов.Хозрасчетный.НайтиПоКоду("6855"));
Параметры.Вставить("СписокПерегружаемыхСчетов6855",СписокПерегружаемыхСчетов6855);

СписокВыгружаемыхОпераций = Новый СписокЗначений;
СписокВыгружаемыхОпераций.Добавить(Перечисления.ВидыОперацийППИсходящее.ОплатаПоставщику);
СписокВыгружаемыхОпераций.Добавить(Перечисления.ВидыОперацийППИсходящее.ВозвратДенежныхСредствПокупателю);
СписокВыгружаемыхОпераций.Добавить(Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("OR0000330")); //Упаковочные материалы (пакеты фасовочные, сетка упаковочная,пленка ПВХ)
Параметры.Вставить("СписокВыгружаемыхОпераций",СписокВыгружаемыхОпераций);


ПланОбмена = ПланыОбмена.ОбменБанкТК.НайтиПоКоду(Параметры.КодУзлаОбмена);
Параметры.Вставить("ПланОбмена",ПланОбмена);</ПередВыгрузкойДанных>
	<Параметры>
		<Параметр Имя="ДатаГраница                                       " Наименование="ДатаГраница                                       " ИспользуетсяПриЗагрузке="false" УстанавливатьВДиалоге="true" ТипЗначения="Дата" ПередаватьПараметрПриВыгрузке="false"/>
		<Параметр Имя="КодУзлаОбмена                                     " Наименование="КодУзлаОбмена" ИспользуетсяПриЗагрузке="false" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="false"/>
	</Параметры>
	<Обработки/>
	<ПравилаКонвертацииОбъектов>
		<Группа>
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило>
				<Код>Валюты</Код>
				<Наименование>Справочник: Валюты</Наименование>
				<Порядок>50</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Валюты</Источник>
				<Приемник>СправочникСсылка.Валюты</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СтавкиНДС</Код>
				<Наименование>Перечисление: Ставки НДС</Наименование>
				<Порядок>100</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>ПеречислениеСсылка.СтавкиНДС</Источник>
				<Приемник>СправочникСсылка.СтавкиНДС</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>БезНДС --&gt; БезНДС</Наименование>
						<Порядок>50</Порядок>
						<Источник>БезНДС</Источник>
						<Приемник>БезНДС</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>НДС0 --&gt; НДС0</Наименование>
						<Порядок>100</Порядок>
						<Источник>НДС0</Источник>
						<Приемник>НДС0</Приемник>
					</Значение>
					<Значение>
						<Код>3</Код>
						<Наименование>НДС20 --&gt; ОсновнаяСтавкаНДС</Наименование>
						<Порядок>150</Порядок>
						<Источник>НДС20</Источник>
						<Приемник>ОсновнаяСтавкаНДС</Приемник>
					</Значение>
					<Значение>
						<Код>4</Код>
						<Наименование>НДС7 --&gt; НДС7</Наименование>
						<Порядок>200</Порядок>
						<Источник>НДС7</Источник>
						<Приемник>НДС7</Приемник>
					</Значение>
					<Значение>
						<Код>5</Код>
						<Наименование>НеНДС --&gt; БезНДС</Наименование>
						<Порядок>250</Порядок>
						<Источник>НеНДС</Источник>
						<Приемник>БезНДС</Приемник>
					</Значение>
				</Значения>
			</Правило>
			<Правило>
				<Код>Организации</Код>
				<Наименование>Справочник: Организации</Наименование>
				<Порядок>150</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Организации</Источник>
				<Приемник>СправочникСсылка.Организации</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>КлассификаторБанков</Код>
				<Наименование>Справочник: Банки</Наименование>
				<Порядок>200</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Банки</Источник>
				<Приемник>СправочникСсылка.КлассификаторБанков</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>КодПоЕДРПОУ --&gt; КодПоЕДРПОУ</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="КодПоЕДРПОУ" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КодПоЕДРПОУ" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>БанковскиеСчетаОрганизаций</Код>
				<Наименование>Справочник: Банковские счета</Наименование>
				<Порядок>250</Порядок>
				<ПриЗагрузке>НеЗамещатьОбъект = Истина;</ПриЗагрузке>
				<ПослеЗагрузки>Если Не ОбъектНайден Тогда
	Отказ = Истина;
КонецЕсли;</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1 тогда
	СтрокаИменСвойствПоиска = "Владелец, НомерСчета, Банк";
ИначеЕсли НомерВариантаПоиска = 2 тогда
	СтрокаИменСвойствПоиска = "Владелец, НомерСчета";
Иначе
	СтрокаИменСвойствПоиска="";
	ПрекратитьПоиск = Истина;
КонецЕсли
</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.БанковскиеСчета</Источник>
				<Приемник>СправочникСсылка.БанковскиеСчетаОрганизаций</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Владелец --&gt; Владелец</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Владелец" Вид="Свойство"/>
						<Приемник Имя="Владелец" Вид="Свойство" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>НомерСчета --&gt; НомерСчета</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="НомерСчета" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НомерСчета" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Банк --&gt; Банк</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Банк" Вид="Реквизит" Тип="СправочникСсылка.Банки"/>
						<Приемник Имя="Банк" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторБанков"/>
						<КодПравилаКонвертации>КлассификаторБанков                               </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Контрагенты</Код>
				<Наименование>Справочник: Контрагенты</Наименование>
				<Порядок>300</Порядок>
				<ПередВыгрузкой>Отказ = Источник.ЭтоГруппа;</ПередВыгрузкой>
				<ПослеЗагрузки>Если Не ОбъектНайден Тогда
	Отказ = Истина;
КонецЕсли;
</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1 тогда
	Если ЗначениеЗаполнено(СвойстваПоиска["КодПоЕДРПОУ"]) и  ЗначениеЗаполнено(СвойстваПоиска["ИННПлательщикаНДС"]) Тогда
		СтрокаИменСвойствПоиска = "КодПоЕДРПОУ, ИННПлательщикаНДС";
	ИначеЕсли  ЗначениеЗаполнено(СвойстваПоиска["КодПоЕДРПОУ"]) Тогда
		СтрокаИменСвойствПоиска = "КодПоЕДРПОУ";
	Иначе
		СтрокаИменСвойствПоиска ="Код";
	КонецЕсли;
ИначеЕсли НомерВариантаПоиска = 2 тогда
	СтрокаИменСвойствПоиска = "Код";
Иначе
	СтрокаИменСвойствПоиска ="КодПоЕДРПОУ";
КонецЕсли;
</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Контрагенты</Источник>
				<Приемник>СправочникСсылка.Контрагенты</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>КодПоЕДРПОУ --&gt; КодПоЕДРПОУ</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="КодПоЕДРПОУ" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КодПоЕДРПОУ" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>ИНН --&gt; ИННПлательщикаНДС</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИННПлательщикаНДС" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ДоговорыКонтрагентов</Код>
				<Наименование>Справочник: Договоры контрагентов</Наименование>
				<Порядок>350</Порядок>
				<ПослеЗагрузки>Если Не ОбъектНайден Тогда
	Отказ = Истина;
КонецЕсли;
</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1 тогда
 
	СтрокаИменСвойствПоиска = "Код, Организация, Контрагент";
 
ИначеЕсли НомерВариантаПоиска = 2 тогда
 
 	СтрокаИменСвойствПоиска = "Дата, Номер, Организация, Контрагент";
	
ИначеЕсли НомерВариантаПоиска = 3 тогда
 
 	СтрокаИменСвойствПоиска = "Наименование, Организация, Контрагент";	
	
Иначе
 
	ПрекратитьПоиск = Истина;
 
КонецЕсли;
</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.ДоговорыКонтрагентов</Источник>
				<Приемник>СправочникСсылка.ДоговорыКонтрагентов</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>7</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Номер" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>10</Код>
						<Наименование>Владелец --&gt; Контрагент</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Владелец" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>9</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ТорговыеПлощадки</Код>
				<Наименование>Перечисление: Виды договоров контрагентов</Наименование>
				<Порядок>400</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Объекты</Источник>
				<Приемник>СправочникСсылка.ТорговыеПлощадки</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Документы</Код>
			<Наименование>Документы</Наименование>
			<Порядок>100</Порядок>
			<Правило>
				<Код>СписаниеБезналичныхДенежныхСредств</Код>
				<Наименование>Документ: Платежное поручение исходящее</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>
НеВыгружать = Ложь;

Если Источник.Проведен = Ложь ИЛИ Источник.ПометкаУдаления ИЛИ НЕ ЗначениеЗаполнено(Источник.Подразделение) Тогда
	НеВыгружать = Истина;
ИначеЕсли Параметры.НеПерегружаемыеОбъекты.НайтиПоЗначению(Источник.Объект) &lt;&gt; Неопределено Тогда
	НеВыгружать = Истина;
ИначеЕсли Параметры.СписокИсключений.НайтиПоЗначению(Источник.Подразделение) &lt;&gt; Неопределено Тогда
	НеВыгружать = Истина;
ИначеЕсли Параметры.СписокПерегружаемыхСчетов.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом) = Неопределено Тогда	
	НеВыгружать = Истина;
ИначеЕсли Параметры.НеПерегружаемыйСписокИсключенийДДС.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) &lt;&gt; Неопределено Тогда
	НеВыгружать = Истина;
ИначеЕсли Параметры.СписокВыгружаемыхОпераций.НайтиПоЗначению(Источник.ВидОперации) = Неопределено  Тогда
	НеВыгружать = Истина;
ИначеЕсли Параметры.СписокПерегружаемыхСчетов6855.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом) &lt;&gt; Неопределено
	И Параметры.СписокВыгружаемыхСтатейДДС6855.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) = Неопределено Тогда
	НеВыгружать = Истина;	
КонецЕсли;

Если Не НеВыгружать Тогда
	Выполнить(Алгоритмы.ПроверкаППВ);
КонецЕсли;

Если НеВыгружать Тогда
	НеСоздаватьЕслиНеНайден = Истина;
	РежимЗаписи = "ОтменаПроведения";
Иначе
	РежимЗаписи = "Проведение";
КонецЕсли;

ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("Проведен", Не НеВыгружать);
ВходящиеДанные.Вставить("ПометкаУдаления", НеВыгружать);</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.Автор =  ПараметрыСеанса.ТекущийПользователь;
Объект.ХозОперация = Справочники.ХозОперации.БанковскаяВыпискаРасход;
Объект.КурсДокумента = 1;

Если Объект.РасшифровкаПлатежа.Количество()&gt; 0 Тогда
	
	Договор = Объект.РасшифровкаПлатежа[0].ДоговорВзаиморасчетов;
	Объект.ТорговаяПлощадка = Договор.ТорговаяПлощадка;
	
	Если НЕ ЗначениеЗаполнено(Договор) Тогда
		Отказ = Истина;
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(Объект.ПодразделениеКомпании) Тогда
		Объект.ПодразделениеКомпании = Договор.Подразделение;
	КонецЕсли;
	
КонецЕсли;

Для Каждого СтрокаСостава Из Объект.РасшифровкаПлатежа Цикл
	СтрокаСостава.СтатьяДДС = Справочники.СтатьиДДС.ОплатаПоставщику;
	СтрокаСостава.ТорговаяПлощадка = Договор.ТорговаяПлощадка;
КонецЦикла;</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>ДокументСсылка.ПлатежноеПоручениеИсходящее</Источник>
				<Приемник>ДокументСсылка.СписаниеБезналичныхДенежныхСредств</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>--&gt; Проведен</Наименование>
						<Порядок>150</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>--&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ВалютаДокумента --&gt; ВалютаДокумента</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ВалютаДокумента" Вид="Реквизит" Тип="СправочникСсылка.Валюты"/>
						<Приемник Имя="ВалютаДокумента" Вид="Реквизит" Тип="СправочникСсылка.Валюты"/>
						<КодПравилаКонвертации>Валюты                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>СчетОрганизации --&gt; БанковскийСчет</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="СчетОрганизации" Вид="Реквизит" Тип="СправочникСсылка.БанковскиеСчета"/>
						<Приемник Имя="БанковскийСчет" Вид="Реквизит" Тип="СправочникСсылка.БанковскиеСчетаОрганизаций"/>
						<КодПравилаКонвертации>БанковскиеСчетаОрганизаций                        </КодПравилаКонвертации>
					</Свойство>
					<Группа>
						<Код>6</Код>
						<Наименование>РасшифровкаПлатежа --&gt; РасшифровкаПлатежа</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>10</Код>
							<Наименование>--&gt; Контрагент</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
							<ПередВыгрузкой>Значение = Источник.Контрагент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>ДоговорКонтрагента --&gt; ДоговорВзаиморасчетов</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="ДоговорКонтрагента" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
							<Приемник Имя="ДоговорВзаиморасчетов" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
							<КодПравилаКонвертации>ДоговорыКонтрагентов                              </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>8</Код>
							<Наименование>--&gt; НазначениеПлатежа</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="НазначениеПлатежа" Вид="Реквизит" Тип="Строка"/>
							<ПередВыгрузкой>Значение = Источник.Комментарий;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>--&gt; НомерДок</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="НомерДок" Вид="Реквизит" Тип="Строка"/>
							<ПередВыгрузкой>Значение = Источник.НомерПоручения;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>--&gt; АвтоЗакрытиеСделок</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="АвтоЗакрытиеСделок" Вид="Реквизит" Тип="Булево"/>
							<ПередВыгрузкой>Значение = Истина;</ПередВыгрузкой>
						</Свойство>
						<Свойство Отключить="true">
							<Код>14</Код>
							<Наименование>--&gt; ТорговаяПлощадка</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="ТорговаяПлощадка" Вид="Реквизит" Тип="СправочникСсылка.ТорговыеПлощадки"/>
							<ПередВыгрузкой>Значение = Источник.Объект;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>СуммаПлатежа --&gt; Сумма</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="СуммаПлатежа" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ПоступлениеБезналичныхДенежныхСредств</Код>
				<Наименование>Документ: Платежное поручение входящее</Наименование>
				<Порядок>100</Порядок>
				<ПередВыгрузкой>
Если Источник.НеДляВыгрузки Тогда
	ПланыОбмена.УдалитьРегистрациюИзменений(Параметры.ПланОбмена, Источник);	
	Отказ = Истина;
Иначе

	НеВыгружать = Ложь;
	Причина = "";	
	
	Если Источник.Проведен = Ложь ИЛИ Источник.ПометкаУдаления ИЛИ НЕ ЗначениеЗаполнено(Источник.Подразделение) Тогда
		НеВыгружать = Истина;
		Причина = "Проверьте документ перед выгрузкой!";
	ИначеЕсли Параметры.НеПерегружаемыеОбъекты.НайтиПоЗначению(Источник.Объект) &lt;&gt; Неопределено Тогда
		НеВыгружать = Истина;
		Причина = "Не перегружаемые объекты";		
	ИначеЕсли Параметры.СписокИсключений.НайтиПоЗначению(Источник.Подразделение) &lt;&gt; Неопределено Тогда
		НеВыгружать = Истина;
		Причина = "Подразделение находится в исключении";		
	ИначеЕсли Параметры.СписокПерегружаемыхСчетов.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом) = Неопределено Тогда	
		НеВыгружать = Истина;
		Причина = "Счет учета " + Источник.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом + " не находится в списке разрешенных";
	ИначеЕсли Параметры.НеПерегружаемыйСписокИсключенийДДС.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) &lt;&gt; Неопределено Тогда
		НеВыгружать = Истина;
		Причина = "Статья " + Источник.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств + " находится в списке исключений";		
	ИначеЕсли Параметры.СписокИсключенийАттика.НайтиПоЗначению(Источник.Подразделение) &lt;&gt; Неопределено
		И Параметры.СписокИсключенийДДС.НайтиПоЗначению(Источник.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) &lt;&gt; Неопределено Тогда
		НеВыгружать = Истина;		
		Причина = "Ислючение выгрузки для Аттики";
	ИначеЕсли Источник.ВидОперации &lt;&gt; Перечисления.ВидыОперацийПоступлениеБезналичныхДенежныхСредств.ОплатаПокупателя 
		И Источник.ВидОперации &lt;&gt; Перечисления.ВидыОперацийПоступлениеБезналичныхДенежныхСредств.ВозвратДенежныхСредствПоставщиком Тогда
		НеВыгружать = Истина;				
		Причина = "Вид операции " + Источник.ВидОперации + " не выгружается!";		
	КонецЕсли;
	
	Если Не НеВыгружать Тогда
		Выполнить(Алгоритмы.ПроверкаППВ);
	КонецЕсли;
	
	Если НеВыгружать Тогда
		НеСоздаватьЕслиНеНайден = Истина;
		РежимЗаписи = "ОтменаПроведения";
		
		//Выполнить(Алгоритмы.ПоказатьСообщение);
	Иначе
		РежимЗаписи = "Проведение";		
	КонецЕсли;
	
	ВходящиеДанные = Новый Структура;
	ВходящиеДанные.Вставить("Проведен", Не НеВыгружать);
	ВходящиеДанные.Вставить("ПометкаУдаления", НеВыгружать);	
КонецЕсли;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.Автор =  ПараметрыСеанса.ТекущийПользователь;
Объект.ХозОперация = Справочники.ХозОперации.БанковскаяВыпискаПоступление;
Объект.КурсДокумента = 1;

Если Объект.РасшифровкаПлатежа.Количество()&gt; 0 Тогда
	
	Договор = Объект.РасшифровкаПлатежа[0].ДоговорВзаиморасчетов;
	Объект.ТорговаяПлощадка = Договор.ТорговаяПлощадка;
	
	Если ПараметрыОбъекта["Эквайринг"] Тогда
		Объект.ХозОперация = Справочники.ХозОперации.БанковскаяВыпискаПоПлатежнымКартамПодразделение;
		Если Не ЗначениеЗаполнено(Объект.ПодразделениеКомпании) Тогда
			Объект.ПодразделениеКомпании = Объект.РасшифровкаПлатежа[0].ТорговаяПлощадка.ПодразделениеКомпании;
		КонецЕсли;
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
			"ВЫБРАТЬ ПЕРВЫЕ 1
			|	ДоговорыВзаиморасчетов.Ссылка КАК Ссылка
			|ИЗ
			|	Справочник.ДоговорыКонтрагентов КАК ДоговорыВзаиморасчетов
			|ГДЕ
			|	ДоговорыВзаиморасчетов.Контрагент = &amp;Контрагент
			|	И ДоговорыВзаиморасчетов.ВидДоговора = ЗНАЧЕНИЕ(Справочник.ВидыДоговоров.БанковскийСчет)
			|	И (ДоговорыВзаиморасчетов.ДатаОкончанияДействия &gt; &amp;ДатаКонца
			|			ИЛИ ДоговорыВзаиморасчетов.ДатаОкончанияДействия = ДАТАВРЕМЯ(1, 1, 1))
			|	И ДоговорыВзаиморасчетов.Организация = &amp;Организация";
		
		Запрос.УстановитьПараметр("Организация", Объект.Организация);
		Запрос.УстановитьПараметр("ДатаКонца", Объект.Дата);
		Запрос.УстановитьПараметр("Контрагент", Объект.РасшифровкаПлатежа[0].Контрагент);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			Объект.РасшифровкаПлатежа[0].ДоговорВзаиморасчетов = ВыборкаДетальныеЗаписи.Ссылка
		КонецЦикла;
		
	ИначеЕсли Не ЗначениеЗаполнено(Объект.ПодразделениеКомпании) Тогда
		Объект.ПодразделениеКомпании = Договор.Подразделение;
	КонецЕсли;
	
КонецЕсли;

Для Каждого СтрокаСостава Из Объект.РасшифровкаПлатежа Цикл
	СтрокаСостава.СтатьяДДС = Справочники.СтатьиДДС.ОплатаОтПокупателя;
	СтрокаСостава.ТорговаяПлощадка = Договор.ТорговаяПлощадка;
КонецЦикла;		
</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>ДокументСсылка.ПлатежноеПоручениеВходящее</Источник>
				<Приемник>ДокументСсылка.ПоступлениеБезналичныхДенежныхСредств</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>--&gt; Проведен</Наименование>
						<Порядок>150</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>--&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ВалютаДокумента --&gt; ВалютаДокумента</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ВалютаДокумента" Вид="Реквизит" Тип="СправочникСсылка.Валюты"/>
						<Приемник Имя="ВалютаДокумента" Вид="Реквизит" Тип="СправочникСсылка.Валюты"/>
						<КодПравилаКонвертации>Валюты                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>СчетОрганизации --&gt; БанковскийСчет</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="СчетОрганизации" Вид="Реквизит" Тип="СправочникСсылка.БанковскиеСчета"/>
						<Приемник Имя="БанковскийСчет" Вид="Реквизит" Тип="СправочникСсылка.БанковскиеСчетаОрганизаций"/>
						<КодПравилаКонвертации>БанковскиеСчетаОрганизаций                        </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>--&gt; Эквайринг</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Эквайринг</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Если Источник.ВидОперации = Перечисления.ВидыОперацийПоступлениеБезналичныхДенежныхСредств.ПоступленияОтПродажПоПлатежнымКартамИБанковскимКредитам Тогда
	Значение = Истина;
Иначе
	Значение = Ложь;
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Если Источник.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств.Код = "OR0000432"		//	Выручка от реализации товаров ОПТ
	И Источник.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом.Код = "68542" Тогда
	Значение = "Сч 68542, Выручка от реализации товаров ОПТ";
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>7</Код>
						<Наименование>РасшифровкаПлатежа --&gt; РасшифровкаПлатежа</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>8</Код>
							<Наименование>--&gt; Контрагент</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<ПередВыгрузкой>Значение = Источник.Контрагент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>ДоговорКонтрагента --&gt; ДоговорВзаиморасчетов</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="ДоговорКонтрагента" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
							<Приемник Имя="ДоговорВзаиморасчетов" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
							<КодПравилаКонвертации>ДоговорыКонтрагентов                              </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>--&gt; НазначениеПлатежа</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="НазначениеПлатежа" Вид="Реквизит" Тип="Строка"/>
							<ПередВыгрузкой>Значение = Источник.Комментарий;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>--&gt; АвтоЗакрытиеСделок</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="АвтоЗакрытиеСделок" Вид="Реквизит" Тип="Булево"/>
							<ПередВыгрузкой>Если ЗначениеЗаполнено(ОбъектКоллекции.Сделка) Тогда
	Значение = Ложь;
Иначе
	Значение = Истина;
КонецЕсли;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>СуммаПлатежа --&gt; Сумма</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="СуммаПлатежа" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство Отключить="true">
							<Код>13</Код>
							<Наименование>--&gt; ТорговаяПлощадка</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="ТорговаяПлощадка" Вид="Реквизит" Тип="СправочникСсылка.ТорговыеПлощадки"/>
							<КодПравилаКонвертации>ТорговыеПлощадки                                  </КодПравилаКонвертации>
							<ПередВыгрузкой>Значение = Источник.Объект;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>14</Код>
							<Наименование>--&gt; ДокументОснование</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="" Вид=""/>
							<ИмяПараметраДляПередачи>ДокументОснование</ИмяПараметраДляПередачи>
							<ПередВыгрузкой>Если ЗначениеЗаполнено(ОбъектКоллекции.Сделка) Тогда
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	СтруктураПодчиненности.Ссылка
		|ИЗ
		|	КритерийОтбора.СтруктураПодчиненности(&amp;Док) КАК СтруктураПодчиненности
		|ГДЕ
		|	СтруктураПодчиненности.Ссылка ССЫЛКА Документ.ОперацияБух";
	
	Запрос.УстановитьПараметр("Док", ОбъектКоллекции.Сделка);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если  ВыборкаДетальныеЗаписи.Следующий() Тогда
		Значение = Строка(ВыборкаДетальныеЗаписи.Ссылка.УникальныйИдентификатор())
	Иначе
		Значение = "НетСделки";
	КонецЕсли;
	
Иначе
	
	Значение = "НетСделки";

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
	</ПравилаКонвертацииОбъектов>
	<ПравилаВыгрузкиДанных>
		<Группа Отключить="false">
			<Код>Документы</Код>
			<Наименование>Документы</Наименование>
			<Порядок>50</Порядок>
			<Правило Отключить="false">
				<Код>ПлатежноеПоручениеИсходящее</Код>
				<Наименование>Платежное поручение исходящее</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>СписаниеБезналичныхДенежныхСредств                </КодПравилаКонвертации>
				<СпособОтбораДанных>ПроизвольныйАлгоритм</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПлатежноеПоручениеИсходящее</ОбъектВыборки>
				<ПередОбработкойПравила>ТипОбъекта				= "ПлатежноеПоручениеИсходящее";
ИмяПравилаПКО			= "СписаниеБезналичныхДенежныхСредств";

Выполнить(Алгоритмы.ВыполнитьВыгрузкуДокументов);

Отказ = Истина;
</ПередОбработкойПравила>
			</Правило>
			<Правило Отключить="false">
				<Код>ПлатежноеПоручениеВходящее</Код>
				<Наименование>Платежное поручение входящее</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>ПоступлениеБезналичныхДенежныхСредств             </КодПравилаКонвертации>
				<СпособОтбораДанных>ПроизвольныйАлгоритм</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПлатежноеПоручениеВходящее</ОбъектВыборки>
				<ПередОбработкойПравила>ТипОбъекта				= "ПлатежноеПоручениеВходящее";
ИмяПравилаПКО			= "ПоступлениеБезналичныхДенежныхСредств";

ИсходящиеДанные = Новый Структура;
ИсходящиеДанные.Вставить("ДопПоля", "ОбъектИзменения.Ссылка.НеДляВыгрузки КАК НеДляВыгрузки,");

Выполнить(Алгоритмы.ВыполнитьВыгрузкуДокументов);

Отказ = Истина;
</ПередОбработкойПравила>
			</Правило>
		</Группа>
	</ПравилаВыгрузкиДанных>
	<ПравилаОчисткиДанных/>
	<Алгоритмы>
		<Алгоритм Имя="ВыполнитьВыгрузкуДокументов" ИспользуетсяПриЗагрузке="false">
			<Текст>ПланОбмена = Параметры.ПланОбмена;

ДокНаВыгрузку = "1000";

ДатаГраница = Параметры.ДатаГраница;

ТекстЗапроса =	"ВЫБРАТЬ ПЕРВЫЕ "+ДокНаВыгрузку+"
|	%ДопПоля%
|	ОбъектИзменения.Ссылка.Дата КАК Дата,
|	ОбъектИзменения.Ссылка.Проведен КАК Проведен,
|	ОбъектИзменения.Ссылка.ПометкаУдаления КАК ПометкаУдаления,
|	ОбъектИзменения.Ссылка,
|   ОбъектИзменения.Ссылка.МоментВремени КАК СсылкаМоментВремени,
|	ОбъектИзменения.НомерСообщения КАК НомерСообщения
|ИЗ
|	Документ.%ТипОбъекта%.Изменения КАК ОбъектИзменения
|ГДЕ
|	ОбъектИзменения.Узел = &amp;Узел
|	И ОбъектИзменения.Ссылка.Дата &gt; &amp;ДатаГраница
|	%ДопОтбор%
|
|УПОРЯДОЧИТЬ ПО
|	НомерСообщения УБЫВ,
|	СсылкаМоментВремени";

ДопПоля = "";
ДопОтбор = "";

Попытка
	Если ТипЗнч(ИсходящиеДанные) = Тип("Структура") Тогда			
		Если ИсходящиеДанные.Свойство("ДопПоля") Тогда
			ДопПоля = ИсходящиеДанные.ДопПоля;
		КонецЕсли;
		
		Если ИсходящиеДанные.Свойство("ДопОтбор") Тогда
			ДопОтбор = ИсходящиеДанные.ДопОтбор;
		КонецЕсли;
	КонецЕсли;
Исключение
КонецПопытки;

ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "%ДопПоля%",	ДопПоля);
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "%ДопОтбор%",	ДопОтбор);
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "%ТипОбъекта%",ТипОбъекта);

Запрос = Новый Запрос;
Запрос.Текст = ТекстЗапроса;
Запрос.УстановитьПараметр("Узел", ПланОбмена);
Запрос.УстановитьПараметр("ДатаГраница", ДатаГраница);

РезультатЗапроса = Запрос.Выполнить();

Если НЕ РезультатЗапроса.Пустой() Тогда 			
	
	таблРезультат = РезультатЗапроса.Выгрузить();						
	МассивСсылок = таблРезультат.ВыгрузитьКолонку("Ссылка");			
	
	ПланыОбмена.ВыбратьИзменения(ПланОбмена,1,МассивСсылок);
	
	Если Не ПустаяСтрока(ИмяПравилаПКО) Тогда
		Для Каждого Документ Из МассивСсылок Цикл
			Попытка
				ВыгрузитьПоПравилу(Документ.Ссылка, , , , ИмяПравилаПКО);
			Исключение
				ПланыОбмена.ЗарегистрироватьИзменения(ПланОбмена, Документ.Ссылка);  
			КонецПопытки;
		КонецЦикла
	КонецЕсли;	
КонецЕсли;			
			
		
	
	//Если Не ПустаяСтрока(ИмяПравилаПКО) Тогда
	//	Для Каждого Документ Из МассивСсылок Цикл
	//		НеВыгружать = Ложь;
	//		НеДляВыгрузки = Ложь;
	//		
	//		Если Документ.Проведен = Ложь ИЛИ Документ.ПометкаУдаления ИЛИ НЕ ЗначениеЗаполнено(Документ.Подразделение) Тогда
	//			НеВыгружать = Истина;
	//		ИначеЕсли Параметры.НеПерегружаемыеОбъекты.НайтиПоЗначению(Документ.Объект) &lt;&gt; Неопределено Тогда
	//			НеВыгружать = Истина;
	//		ИначеЕсли Параметры.СписокИсключений.НайтиПоЗначению(Документ.Подразделение) &lt;&gt; Неопределено Тогда
	//			НеВыгружать = Истина;
	//		ИначеЕсли Параметры.СписокПерегружаемыхСчетов.НайтиПоЗначению(Документ.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом) = Неопределено Тогда	
	//			НеВыгружать = Истина;
	//		ИначеЕсли Параметры.НеПерегружаемыйСписокИсключенийДДС.НайтиПоЗначению(Документ.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) &lt;&gt; Неопределено Тогда
	//			НеВыгружать = Истина;
	//		КонецЕсли;
	//		
	//		Если ТипОбъекта = "ПлатежноеПоручениеВходящее" И Документ.НеДляВыгрузки Тогда
	//			НеДляВыгрузки = Истина;	
	//		КонецЕсли;
	//	
	//		Если НеВыгружать = Ложь Тогда
	//			Если ТипОбъекта = "ПлатежноеПоручениеИсходящее" Тогда
	//				Если Параметры.СписокВыгружаемыхОпераций.НайтиПоЗначению(Документ.ВидОперации) = Неопределено  Тогда
	//					НеВыгружать = Истина;
	//				ИначеЕсли Параметры.СписокПерегружаемыхСчетов6855.НайтиПоЗначению(Документ.РасшифровкаПлатежа[0].СчетУчетаРасчетовСКонтрагентом) &lt;&gt; Неопределено
	//					И Параметры.СписокВыгружаемыхСтатейДДС6855.НайтиПоЗначению(Документ.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) = Неопределено Тогда
	//					НеВыгружать = Истина;
	//				КонецЕсли;
	//			ИначеЕсли ТипОбъекта = "ПлатежноеПоручениеВходящее" Тогда
	//				Выполнить(Алгоритмы.ПроверкаППВ);
	//				Если НеВыгружать Тогда
	//				ИначеЕсли Параметры.СписокИсключенийАттика.НайтиПоЗначению(Документ.Подразделение) &lt;&gt; Неопределено
	//					И Параметры.СписокИсключенийДДС.НайтиПоЗначению(Документ.РасшифровкаПлатежа[0].СтатьяДвиженияДенежныхСредств) &lt;&gt; Неопределено Тогда
	//					НеВыгружать = Истина;
	//				ИначеЕсли Документ.ВидОперации &lt;&gt; Перечисления.ВидыОперацийПоступлениеБезналичныхДенежныхСредств.ОплатаПокупателя 
	//					И Документ.ВидОперации &lt;&gt; Перечисления.ВидыОперацийПоступлениеБезналичныхДенежныхСредств.ВозвратДенежныхСредствПоставщиком Тогда
	//					НеВыгружать = Истина;
	//				КонецЕсли;					
	//			КонецЕсли;
	//		КонецЕсли;
	//		
	//		Если НеДляВыгрузки Тогда
	//			ПланыОбмена.УдалитьРегистрациюИзменений(ПланОбмена, Документ.Ссылка);		
	//		Иначе
	//			Попытка
	//				ВыгрузитьПоПравилу(Документ.Ссылка, , Новый Структура("НаУдаление", НеВыгружать), , ИмяПравилаПКО);
	//			Исключение
	//				ПланыОбмена.ЗарегистрироватьИзменения(ПланОбмена, Документ.Ссылка);  
	//			КонецПопытки;
	//		КонецЕсли;
	//		
	//	КонецЦикла;
	//КонецЕсли;


</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПоказатьСообщение" ИспользуетсяПриЗагрузке="false">
			<Текст>Сообщение("Не выгружен объект: """ + Строка(Источник) + """" + Символы.ПС + Причина);</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПроверкаППВ" ИспользуетсяПриЗагрузке="false">
			<Текст>Запрос = Новый Запрос;
Запрос.Текст = 
"ВЫБРАТЬ
|	ЗначенияСвойствОбъектов.Значение
|ИЗ
|	РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
|ГДЕ
|	ЗначенияСвойствОбъектов.Свойство = &amp;Свойство
|	И ЗначенияСвойствОбъектов.Объект = &amp;Объект";

Запрос.УстановитьПараметр("Объект", Источник);
Запрос.УстановитьПараметр("Свойство", Параметры.СвойствоНеПерегружать);

РезультатЗапроса = Запрос.Выполнить();

Если НЕ РезультатЗапроса.Пустой() Тогда
	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	НеВыгружать = Выборка.Значение;	
	
	Если НеВыгружать Тогда
		Причина = "Заполнено свойство ""Не перегружать""";		
	КонецЕсли;
КонецЕсли;</Текст>
		</Алгоритм>
	</Алгоритмы>
	<Запросы/>
</ПравилаОбмена>